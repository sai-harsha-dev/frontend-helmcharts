pipeline{
    parameters {
        string defaultValue: 'localhost:8081/frontend', name: 'IMAGE'
    }

    agent any

    stages{
     
        stage("Clone"){
            steps{
                sh 'git clone https://github.com/sai-harsha-dev/frontend-helmcharts.git'
                }
                }
            
        stage ("Add Image URI"){
            steps{
                sh 'sed -i \'s/image:*/image: vnsharsha7999\\/frontend:v1/\' frontend-helm-chart/values.yaml'
            }
        }

        stage ("Git commit and push"){
            steps{
                withCredentials([gitUsernamePassword(credentialsId: 'jenkins-github-token', gitToolName: 'Default')]) {
                    sh 'git add .'
                    sh 'git commit -m "updated image to ${IMAGE}"'
                    sh 'git push origin main' }
            }
        }
    }
}
